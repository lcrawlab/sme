<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Sparse Marginal Epistasis Test (SME) — sme • smer</title><script src="../lightswitch.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Sparse Marginal Epistasis Test (SME) — sme"><meta name="description" content="SME fits a linear mixed model in order to test for marginal epistasis. It
concentrates the scans for epistasis to regions of the genome that have known
functional enrichment for a trait of interest."><meta property="og:description" content="SME fits a linear mixed model in order to test for marginal epistasis. It
concentrates the scans for epistasis to regions of the genome that have known
functional enrichment for a trait of interest."><meta property="og:image" content="https://lcrawlab.github.io/sme/logo.png"><script defer data-domain="pkgdown.r-lib.org,all.tidyverse.org" src="https://plausible.io/js/plausible.js"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top " aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">smer</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/smer.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Tutorials</h6></li>
    <li><a class="dropdown-item" href="../articles/tutorial-cite-us.html">How To Cite Our Work</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-create-mask-file.html">How To Create a Mask File</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-memory-optimization.html">How To Optimize the Memory Requirements of SME</a></li>
    <li><a class="dropdown-item" href="../articles/tutorial-simulate-traits.html">How To Simulate Traits</a></li>
    <li><hr class="dropdown-divider"></li>
    <li><h6 class="dropdown-header" data-toc-skip>Studies</h6></li>
    <li><a class="dropdown-item" href="../articles/study-erythroid-differentiation-data.html">Conditioning Epistasis Search on Open Chromatin</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/lcrawlab/sme/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-lightswitch" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true" aria-label="Light switch"><span class="fa fa-sun"></span></button>
  <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="dropdown-lightswitch"><li><button class="dropdown-item" data-bs-theme-value="light"><span class="fa fa-sun"></span> Light</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="dark"><span class="fa fa-moon"></span> Dark</button></li>
    <li><button class="dropdown-item" data-bs-theme-value="auto"><span class="fa fa-adjust"></span> Auto</button></li>
  </ul></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Sparse Marginal Epistasis Test (SME)</h1>
      <small class="dont-index">Source: <a href="https://github.com/lcrawlab/sme/blob/main/R/sme.R" class="external-link"><code>R/sme.R</code></a></small>
      <div class="d-none name"><code>sme.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>SME fits a linear mixed model in order to test for marginal epistasis. It
concentrates the scans for epistasis to regions of the genome that have known
functional enrichment for a trait of interest.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sme</span><span class="op">(</span></span>
<span>  <span class="va">plink_file</span>,</span>
<span>  <span class="va">pheno_file</span>,</span>
<span>  mask_file <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  gxg_indices <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  chunk_size <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  n_randvecs <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  n_blocks <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  n_threads <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  gxg_h5_group <span class="op">=</span> <span class="st">"gxg"</span>,</span>
<span>  ld_h5_group <span class="op">=</span> <span class="st">"ld"</span>,</span>
<span>  rand_seed <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>,</span>
<span>  log_level <span class="op">=</span> <span class="st">"WARNING"</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-plink-file">plink_file<a class="anchor" aria-label="anchor" href="#arg-plink-file"></a></dt>
<dd><p>Character. File path to the PLINK dataset
(without *.bed extension).
The function will append <code>.bim</code>, <code>.bed</code>, and <code>.fam</code> extensions
automatically.
The genotype data must not have any missing genotypes. Use PLINK to remove
variants with missing genotypes or impute them.</p></dd>


<dt id="arg-pheno-file">pheno_file<a class="anchor" aria-label="anchor" href="#arg-pheno-file"></a></dt>
<dd><p>Character. File path to a phenotype file in PLINK format.
The file should contain exactly one phenotype column.</p></dd>


<dt id="arg-mask-file">mask_file<a class="anchor" aria-label="anchor" href="#arg-mask-file"></a></dt>
<dd><p>Character or NULL. File path to an HDF5 file specifying
per-SNP masks for gene-by-gene interaction tests. This file informs which
SNPs are tested for marginal epistasis. Defaults to <code>NULL</code>, indicating no
masking. Masking impacts the scaling of memory and time.</p></dd>


<dt id="arg-gxg-indices">gxg_indices<a class="anchor" aria-label="anchor" href="#arg-gxg-indices"></a></dt>
<dd><p>Integer vector or NULL. List of indices corresponding to
SNPs to test for marginal epistasis.
If <code>NULL</code>, all SNPs in the dataset will be tested.
These indices are <strong>1-based</strong>.</p></dd>


<dt id="arg-chunk-size">chunk_size<a class="anchor" aria-label="anchor" href="#arg-chunk-size"></a></dt>
<dd><p>Integer or NULL. Number of SNPs processed per chunk.
This influences memory
usage and can be left <code>NULL</code> to automatically determine the chunk size
based on <code>gxg_indices</code> and number of threads.</p></dd>


<dt id="arg-n-randvecs">n_randvecs<a class="anchor" aria-label="anchor" href="#arg-n-randvecs"></a></dt>
<dd><p>Integer. Number of random vectors used for stochastic trace
estimation.
Higher values yield more accurate estimates but increase computational
cost. Default is 10.</p></dd>


<dt id="arg-n-blocks">n_blocks<a class="anchor" aria-label="anchor" href="#arg-n-blocks"></a></dt>
<dd><p>Integer. Number of blocks into which SNPs are divided for
processing.
This parameter affects memory requirements. Default is 100.</p></dd>


<dt id="arg-n-threads">n_threads<a class="anchor" aria-label="anchor" href="#arg-n-threads"></a></dt>
<dd><p>Integer. Number of threads for OpenMP parallel processing.
Default is 1.</p></dd>


<dt id="arg-gxg-h-group">gxg_h5_group<a class="anchor" aria-label="anchor" href="#arg-gxg-h-group"></a></dt>
<dd><p>Character. Name of the HDF5 group within the mask file
containing gene-by-gene
interaction masks. SNPs in this group will be included in the gene-by-gene
interactions. Defaults to "gxg".</p></dd>


<dt id="arg-ld-h-group">ld_h5_group<a class="anchor" aria-label="anchor" href="#arg-ld-h-group"></a></dt>
<dd><p>Character. Name of the HDF5 group within the mask file
containing linkage disequilibrium
masks. SNPs in this group are excluded from analysis. Defaults to "ld".</p></dd>


<dt id="arg-rand-seed">rand_seed<a class="anchor" aria-label="anchor" href="#arg-rand-seed"></a></dt>
<dd><p>Integer. Seed for random vector generation. If <code>-1</code>, no seed
is set. Default is -1.</p></dd>


<dt id="arg-log-level">log_level<a class="anchor" aria-label="anchor" href="#arg-log-level"></a></dt>
<dd><p>Character. Logging level for messages. Must be in uppercase
(e.g., "DEBUG", "INFO", "WARNING", "ERROR"). Default is "WARNING".</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing:</p><ul><li><p><code>summary</code>: A tibble summarizing results for each tested SNP, including:</p><ul><li><p><code>id</code>: Variant ID.</p></li>
<li><p><code>index</code>: Index of the SNP in the dataset.</p></li>
<li><p><code>chromosome</code>: Chromosome number.</p></li>
<li><p><code>position</code>: Genomic position of the SNP.</p></li>
<li><p><code>p</code>: P value for the gene-by-gene interaction test.</p></li>
<li><p><code>pve</code>: Proportion of variance explained (PVE) by gene-by-gene interactions.</p></li>
<li><p><code>vc</code>: Variance component estimate.</p></li>
<li><p><code>se</code>: Standard error of the variance component.</p></li>
</ul></li>
<li><p><code>pve</code>: A long-format tibble of PVE for all variance components.</p></li>
<li><p><code>vc_estimate</code>: A long-format tibble of variance component estimates.</p></li>
<li><p><code>vc_se</code>: A long-format tibble of standard errors for variance components.</p></li>
<li><p><code>average_duration</code>: Average computation time per SNP.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function integrates PLINK-formatted genotype and phenotype data to
perform marginal epistasis tests on a set of SNPs. Using stochastic trace
estimation, the method computes variance components for gene-by-gene
interaction and genetic relatedness using the MQS estimator. The process is
parallelized using OpenMP when <code>n_threads &gt; 1</code>.</p>
<p>The memory requirements and computation time scaling can be optimized through
the parameters <code>chunk_size</code>, <code>n_randvecs</code>, and <code>n_blocks</code>.</p>
<p><strong>Mask Format Requirements</strong></p>
<p>The mask file format is an HDF5 file used for storing index data for
the masking process. This format supports data retrieval by index.
Below are the required groups and datasets within the HDF5 file:</p>
<p>The required group names can be configured as input parameters.
The defaults are described below.</p><ul><li><p><strong>Groups</strong>:</p><ul><li><p><code>ld</code>: Stores SNPs in LD with the focal SNP. These SNPs will be <strong>excluded</strong>.</p></li>
<li><p><code>gxg</code>: Stores indices of SNPs that the marginal epistasis test is conditioned on. These SNPs will be <strong>included</strong>.</p></li>
</ul></li>
<li><p><strong>Datasets</strong>:</p><ul><li><p><code>ld/&lt;j&gt;</code>: For each focal SNP <code>&lt;j&gt;</code>, this dataset contains indices of SNPs
in the same LD block as that SNP. These SNPs will be <strong>excluded</strong> from the gene-by-gene interaction covariance matrix.</p></li>
<li><p><code>gxg/&lt;j&gt;</code>: For each focal SNP <code>&lt;j&gt;</code>, this dataset contains indices of SNPs to <strong>include</strong> in the
the gene-by-gene interaction covariance matrix for focal SNP <code>&lt;j&gt;</code>.</p></li>
</ul></li>
</ul><p><strong>Important</strong>: All indices in the mask file data are <strong>zero-based</strong>, matching the zero-based indices of the PLINK <code>.bim</code> file.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Stamp, J., Pattillo Smith, S., Weinreich, D., &amp; Crawford, L. (2025).
Sparse modeling of interactions enables fast detection of genome-wide
epistasis in biobank-scale studies. bioRxiv, 2025.01.11.632557.</p>
<p>Stamp, J., DenAdel, A., Weinreich, D., &amp; Crawford, L. (2023).
Leveraging the genetic correlation between traits improves the detection of
epistasis in genome-wide association studies.
G3: Genes, Genomes, Genetics, 13(8), jkad118.</p>
<p>Crawford, L., Zeng, P., Mukherjee, S., &amp; Zhou, X. (2017).
Detecting epistasis with the marginal epistasis test in genetic mapping
studies of quantitative traits. PLoS genetics, 13(7), e1006869.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">plink_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"\\.bed"</span>, <span class="st">""</span>, <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata"</span>, <span class="st">"test.bed"</span>, package<span class="op">=</span><span class="st">"smer"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pheno_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"testdata"</span>, <span class="st">"test_h2_0.5.pheno"</span>, package<span class="op">=</span><span class="st">"smer"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">mask_file</span> <span class="op">&lt;-</span> <span class="st">""</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Parameter inputs</span></span></span>
<span class="r-in"><span><span class="va">chunk_size</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">n_randvecs</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">n_blocks</span> <span class="op">&lt;-</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="va">n_threads</span> <span class="op">&lt;-</span> <span class="fl">1</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># 1-based Indices of SNPs to be analyzed</span></span></span>
<span class="r-in"><span><span class="va">n_snps</span> <span class="op">&lt;-</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">snp_indices</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="va">n_snps</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">sme_result</span> <span class="op">&lt;-</span> <span class="fu">sme</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="va">plink_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">pheno_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">mask_file</span>,</span></span>
<span class="r-in"><span>  <span class="va">snp_indices</span>,</span></span>
<span class="r-in"><span>  <span class="va">chunk_size</span>,</span></span>
<span class="r-in"><span>  <span class="va">n_randvecs</span>,</span></span>
<span class="r-in"><span>  <span class="va">n_blocks</span>,</span></span>
<span class="r-in"><span>  <span class="va">n_threads</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">sme_result</span><span class="op">$</span><span class="va">summary</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 6 × 8</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   id    index chromosome position     p      pve       vc     se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">1</span> rs1       1          1        1 0.635 -<span style="color: #BB0000;">0.015</span><span style="color: #BB0000; text-decoration: underline;">0</span>  -<span style="color: #BB0000;">0.014</span><span style="color: #BB0000; text-decoration: underline;">6</span>  0.042<span style="text-decoration: underline;">5</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">2</span> rs2       2          1        2 0.133  0.050<span style="text-decoration: underline;">5</span>   0.049<span style="text-decoration: underline;">2</span>  0.044<span style="text-decoration: underline;">3</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">3</span> rs3       3          1        3 0.420  0.011<span style="text-decoration: underline;">7</span>   0.011<span style="text-decoration: underline;">4</span>  0.056<span style="text-decoration: underline;">7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">4</span> rs4       4          1        4 0.136  0.089<span style="text-decoration: underline;">7</span>   0.087<span style="text-decoration: underline;">5</span>  0.079<span style="text-decoration: underline;">7</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">5</span> rs5       5          1        5 0.948 -<span style="color: #BB0000;">0.049</span><span style="color: #BB0000; text-decoration: underline;">2</span>  -<span style="color: #BB0000;">0.047</span><span style="color: #BB0000; text-decoration: underline;">9</span>  0.029<span style="text-decoration: underline;">4</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">6</span> rs6       6          1        6 0.473  0.004<span style="text-decoration: underline;">07</span>  0.003<span style="text-decoration: underline;">96</span> 0.058<span style="text-decoration: underline;">6</span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Julian Stamp, Lorin Crawford.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

